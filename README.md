# Лабораторная работа 1

## Инструкция по использованию
Для запуска необходимо скачать **jdk** или **jre**
Запуск можно производить из командной строки или из IDE.
Для второго варианта запуск зависит от конкретной IDE, в случае первого варината необходимо:
1. Зайти в папку с проектом
2. В командную строчку ввести команду:   
` java -jar out/artifacts/<target>_jar/2020H2.jar` <аргументы командной строки>

В качетсве `target` может быть 4 варианта: 
1. **Server** (Сервер на обычных TCP сокетах)
2. **Client** (Клиент на обычных TCP сокетах)
3. **NIOServer** (Сервер на неблокирующих TCP сокетах)
4. **NIOClient** (Сервер на неблокирующих TCP сокетах)

Все __jar-файлы__ лежат в папках `out/artifacts/<target>_jar/`, откуда их можно забрать в случае необходимости

## Протокол
Имеется один общий тип пакета, он отправляется от клиента к серверу и от сервера клиенту.   
В пунктах `a` и `b` структура пакета не меняется
Формат пакета:
 
Name length | Name | Message length| Message | End
--|--|--|--|--

`Name length` и `Message length` занимают по 1 байту, то есть максимальная длина сообщения и имени - 127 символов.
Флаг `End` показывает последние ли сообщение из общего потока.
Данный влаг нужен для того, чтобы передавать по частям большое сообщение от пользователя.
`Name` и `Message` передаются в формате `utf-8`.
Время сообщения возлагается на клиентов, по причине того, что у пользователей могут быть разные часовые пояса.

## Реализация 
Реализация обоих пунктов похожа, за исключением самих сокетов. Обычные сокеты были взяты из пакета  `java.net`, а неблокирующие взяты из `java.nio`.

###Сервер

При запуске сервера считываются аргументы командной строки. На сервере логируется информация о подключении, также логиуруются сообщения пользователей и их имена просто для красоты, в реальном серверере такого не должно быть.
Сохраняются только имена пользователей для того, чтобы при попытке отправить сообщение не от своего лица, вставлялось имя реального отправителя..

###Клиент

При запуске клиента также считываются аргументы командной строки, у пользователя запрашивается имя. Имя отправляется вместе с каждым сообщением, так как имена пользователей не хранятся на сервере. Выйти из программы можно с помощью команды "quit". Если запустить клиент, а сервер в этот момент не будет работать, выведется соответсвтующее сообщение и программа завершит работу.

